# 聊天网站 Chat Site

一个基于Flask和原生JavaScript的实时聊天网站，支持用户注册、好友管理和实时消息传递功能。

## 功能特性

- 用户登录认证
- 好友管理系统（添加好友、好友列表）
- 实时聊天功能
- 深色/浅色主题切换
- 响应式设计，适配移动端和桌面端
- 玻璃态设计风格
- 未读消息提示
- WebSocket实时通信
- 多标签页独立登录

## 技术栈

- 后端：Python Flask, Flask-SocketIO
- 前端：HTML, CSS, JavaScript (原生)
- 数据库：SQLite
- 样式：自定义CSS，Font Awesome图标

## 项目结构

```
chat-site/
├── backend/
│   └── app.py              # Flask后端应用
├── data/
│   ├── users.json          # 用户账户信息
│   ├── users/              # 用户好友列表目录
│   └── chat.db             # SQLite数据库
├── frontend/
│   ├── index.html          # 主页（好友列表）
│   ├── login.html          # 登录页
│   ├── chat.html           # 聊天页面
│   └── static/
│       ├── css/
│       │   └── style.css   # 样式文件
│       └── js/
│           ├── login.js    # 登录页逻辑
│           ├── chat.js     # 主页逻辑
│           └── friends.js  # 聊天页逻辑
└── uploads/                # 上传文件目录（暂未使用）
```

## 安装与运行

1. 确保已安装Python 3.7+

2. 安装依赖：
   ```bash
   pip install flask flask-socketio
   ```

3. 运行应用：
   ```bash
   python backend/app.py
   ```

4. 访问应用：
   打开浏览器访问 http://localhost

## 使用说明

### 登录系统
- 默认用户：
  - 用户名: alice, 密码: alice888
  - 用户名: bob, 密码: 123456
- 可以在[data/users.json](file:///E:/code/chat-site/data/users.json)中添加更多用户

### 主要功能

1. **添加好友**
   - 在主页的"添加好友"区域输入用户名
   - 点击"添加"按钮即可添加好友

2. **聊天功能**
   - 点击好友卡片进入聊天界面
   - 输入消息并点击发送或按回车键发送

3. **主题切换**
   - 点击右上角的主题切换开关可以在深色和浅色主题间切换

4. **个人信息设置**
   - 点击右上角齿轮图标打开设置面板
   - 可以修改用户名和密码

5. **未读消息提示**
   - 在好友列表中，每个好友卡片上会显示未读消息数量
   - 有新消息时会实时更新未读数

6. **多标签页支持**
   - 可以在浏览器中打开多个标签页，每个标签页可以独立登录不同账号
   - 各标签页之间的会话互不影响

## 设计特点

- **玻璃态设计**：采用现代化的毛玻璃效果界面
- **响应式布局**：适配各种屏幕尺寸
- **实时通信**：使用WebSocket实现实时消息推送
- **自动刷新**：结合WebSocket推送和定时轮询确保数据同步
- **会话隔离**：使用Session Storage实现多标签页独立登录

## 开发注意事项

- 前端通过sessionStorage存储用户会话信息，localStorage存储主题偏好
- 后端API采用RESTful风格设计
- 使用原生JavaScript，无框架依赖
- CSS变量实现主题切换功能

## 已知问题与限制

- 用户认证机制较为简单，仅用于演示
- 未实现消息撤回、图片发送等高级功能

## 更新日志

- 实现了基本的聊天功能
- 添加了好友管理功能
- 实现了深色/浅色主题切换
- 解决了主题切换时的页面闪烁问题
- 优化了UI界面和交互体验
- 实现了未读消息提示功能
- 集成WebSocket实现实时通信
- 移除了过时的JSON文件存储机制
- 支持多标签页独立登录
- 优化日志输出，合并统计信息显示，保持高频轮询确保消息实时性